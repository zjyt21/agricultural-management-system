{"ast":null,"code":"import \"core-js/modules/es.array.includes.js\";\nimport Vue from 'vue';\nimport VueRouter from 'vue-router';\nimport Container from '../views/Container.vue';\nimport Home from '../views/Home.vue';\nimport Login from '../views/Login.vue';\nimport Register from '../views/Register.vue';\nimport NotFound from '../views/NotFound.vue';\nimport Person from '../views/Person.vue';\nVue.use(VueRouter);\nconst routes = [{\n  path: '/login',\n  name: 'Login',\n  component: Login\n}, {\n  path: '/register',\n  name: 'Register',\n  component: Register\n}, {\n  path: '/notFound',\n  name: 'NotFound',\n  component: NotFound\n}];\nconst router = new VueRouter({\n  mode: 'history',\n  base: process.env.BASE_URL,\n  routes\n}); // 提供一个重置路由的方法\n\nexport const resetRouter = () => {\n  router.matcher = new VueRouter({\n    mode: 'history',\n    base: process.env.BASE_URL,\n    routes\n  });\n};\nexport const setRoutes = () => {\n  const storeMenus = localStorage.getItem(\"menus\");\n\n  if (storeMenus) {\n    const currentRoutes = router.getRoutes().map(v => v.name);\n\n    if (!currentRoutes.includes('Container')) {\n      //dynamic route\n      const manageRoute = {\n        path: '/',\n        name: 'Container',\n        component: Container,\n        redirect: \"/home\",\n        children: [{\n          path: 'person',\n          name: 'User Info',\n          component: Person,\n          meta: {\n            name: 'User Information'\n          }\n        }]\n      };\n      const menus = JSON.parse(storeMenus);\n      menus.forEach(item => {\n        if (item.path) {\n          let itemMenu = {\n            path: item.path.replace(\"/\", \"\"),\n            name: item.pagePath,\n            component: () => import('../views/' + item.pagePath + '.vue'),\n            meta: {\n              name: item.name\n            }\n          };\n          manageRoute.children.push(itemMenu);\n        } else if (item.children.length) {\n          item.children.forEach(subItem => {\n            if (subItem.path) {\n              let subItemMenu = {\n                path: subItem.path.replace(\"/\", \"\"),\n                name: subItem.pagePath,\n                component: () => import('../views/' + subItem.pagePath + '.vue'),\n                meta: {\n                  name: subItem.name\n                }\n              };\n              manageRoute.children.push(subItemMenu);\n            }\n          });\n        }\n      });\n      router.addRoute(manageRoute);\n    }\n  }\n}; //reset routes\n\nsetRoutes();\nrouter.beforeEach((to, from, next) => {\n  const storeMenus = localStorage.getItem(\"menus\");\n\n  if (!to.matched.length) {\n    if (storeMenus) {\n      next(\"/notFound\");\n    } else {\n      next(\"/login\");\n    }\n  }\n\n  next();\n});\nexport default router;","map":{"version":3,"names":["Vue","VueRouter","Container","Home","Login","Register","NotFound","Person","use","routes","path","name","component","router","mode","base","process","env","BASE_URL","resetRouter","matcher","setRoutes","storeMenus","localStorage","getItem","currentRoutes","getRoutes","map","v","includes","manageRoute","redirect","children","meta","menus","JSON","parse","forEach","item","itemMenu","replace","pagePath","push","length","subItem","subItemMenu","addRoute","beforeEach","to","from","next","matched"],"sources":["E:/environment/project/agricultural-management-system/web/src/router/index.js"],"sourcesContent":["import Vue from 'vue'\nimport VueRouter from 'vue-router'\nimport Container from '../views/Container.vue'\nimport Home from '../views/Home.vue'\nimport Login from '../views/Login.vue'\nimport Register from '../views/Register.vue'\nimport NotFound from '../views/NotFound.vue'\nimport Person from '../views/Person.vue'\n\n\nVue.use(VueRouter)\n\nconst routes = [\n  {path: '/login', name: 'Login', component: Login,},\n  {path: '/register', name: 'Register', component: Register,},\n  {path: '/notFound', name: 'NotFound', component: NotFound,},\n]\n\nconst router = new VueRouter({\n  mode: 'history',\n  base: process.env.BASE_URL,\n  routes\n})\n\n// 提供一个重置路由的方法\nexport const resetRouter = () => {\n  router.matcher = new VueRouter({\n    mode: 'history',\n    base: process.env.BASE_URL,\n    routes\n  })\n}\n\nexport const setRoutes = () => {\n  const storeMenus = localStorage.getItem(\"menus\");\n  if(storeMenus){\n    \n    const currentRoutes = router.getRoutes().map(v => v.name)\n    if(!currentRoutes.includes('Container')){\n      //dynamic route\n      const manageRoute = { path: '/', name:'Container', component: Container, redirect:\"/home\", \n        children:[\n          { path:'person', name:'User Info', component: Person, meta:{ name: 'User Information'},},\n        ]}\n      const menus = JSON.parse(storeMenus)\n      menus.forEach(item => {\n        if(item.path){\n          let itemMenu = { path: item.path.replace(\"/\", \"\"), name: item.pagePath, component:() => import('../views/' + item.pagePath + '.vue'), meta:{ name: item.name}}\n          manageRoute.children.push(itemMenu)\n        }else if(item.children.length){\n          item.children.forEach(subItem => {\n            if(subItem.path){\n              let subItemMenu = { path: subItem.path.replace(\"/\", \"\"), name: subItem.pagePath, component:() => import('../views/' + subItem.pagePath + '.vue'), meta:{ name: subItem.name}}\n              manageRoute.children.push(subItemMenu)\n            }  \n          })\n        }\n      });\n      router.addRoute(manageRoute)\n    }\n    \n  }\n}\n\n//reset routes\nsetRoutes()\n\nrouter.beforeEach((to, from, next) => {\n  const storeMenus = localStorage.getItem(\"menus\")\n  if (!to.matched.length) {\n    if(storeMenus){\n      next(\"/notFound\")\n    }else{\n      next(\"/login\")\n    }\n  }\n  next()\n})\nexport default router\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}