"use strict";(self["webpackChunkfarmer_center"]=self["webpackChunkfarmer_center"]||[]).push([[703],{4703:function(e,t,a){a.r(t),a.d(t,{default:function(){return d}});var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{staticClass:"demo-form-inline",staticStyle:{"text-align":"center"},attrs:{inline:!0}},[a("el-form-item",[a("el-date-picker",{attrs:{type:"daterange","unlink-panels":"","range-separator":"to","start-placeholder":"Begin date","end-placeholder":"End date","value-format":"yyyy-MM-dd"},model:{value:e.chartDateVal,callback:function(t){e.chartDateVal=t},expression:"chartDateVal"}})],1),a("el-form-item",[a("el-button",{staticClass:"ml-5",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.getChart}},[e._v("Search")])],1)],1),a("el-row",{staticStyle:{"margin-bottom":"40px"},attrs:{gutter:10}},[a("el-col",{attrs:{span:2}}),a("el-col",{attrs:{span:12}},[a("el-card",{staticClass:"chart",staticStyle:{height:"500px"},attrs:{id:"price"}})],1),a("el-col",{attrs:{span:12}},[a("el-card",{staticClass:"chart",staticStyle:{height:"500px"},attrs:{id:"trend"}})],1)],1),a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[a("el-form-item",{attrs:{prop:"crop"}},[a("el-select",{attrs:{filterable:"",placeholder:"Please select a crop name"},model:{value:e.crop,callback:function(t){e.crop=t},expression:"crop"}},[a("el-option",{attrs:{label:"paddy",value:"paddy"}}),a("el-option",{attrs:{label:"potato",value:"potato"}}),a("el-option",{attrs:{label:"soybean",value:"soybean"}}),a("el-option",{attrs:{label:"peanut",value:"peanut"}}),a("el-option",{attrs:{label:"wheat",value:"wheat"}}),a("el-option",{attrs:{label:"barley",value:"barley"}})],1)],1),a("el-form-item",{attrs:{prop:"date"}},[a("el-date-picker",{attrs:{type:"daterange","unlink-panels":"","range-separator":"to","start-placeholder":"Begin date","end-placeholder":"End date","picker-options":e.pickerOptions,"value-format":"yyyy-MM-dd"},model:{value:e.dateVal,callback:function(t){e.dateVal=t},expression:"dateVal"}})],1),a("el-form-item",[a("el-button",{staticClass:"ml-5",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.loadPage}},[e._v("Search")]),a("el-button",{staticClass:"ml-5",attrs:{type:"warning",icon:"el-icon-refresh"},on:{click:e.reset}},[e._v("Reset")])],1)],1),a("div",{staticStyle:{margin:"10px 0"}},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleAdd}},[e._v("Add "),a("i",{staticClass:"el-icon-circle-plus-outline"})]),a("el-popconfirm",{staticClass:"ml-5",attrs:{"confirm-button-text":"DELETE","cancel-button-text":"CANCEL",icon:"el-icon-info","icon-color":"red",title:"Are you sure you want to delete these data?"},on:{confirm:e.delBatch,cancel:e.cancel}},[a("el-button",{attrs:{slot:"reference",type:"danger"},slot:"reference"},[e._v("Delete in bulk "),a("i",{staticClass:"el-icon-remove-outline"})])],1)],1),a("el-table",{attrs:{data:e.tableData,"default-sort":{prop:"date",order:"descending"},border:"",stripe:"","header-cell-style":{textAlign:"center",background:"beige"},"cell-style":e.rowClass},on:{"selection-change":e.handleSelectionChange}},[a("div",{staticStyle:{"text-align":"left"},attrs:{slot:"empty"},slot:"empty"},[a("el-empty",{attrs:{description:"Sorry, there is no data you are looking for"}})],1),a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{prop:"date",label:"Date",sortable:"",width:"100"}}),a("el-table-column",{attrs:{prop:"crop",label:"Crop",width:"150"}}),a("el-table-column",{attrs:{prop:"unitPrice",label:"Unit Price (GBP per ton)",sortable:""}}),a("el-table-column",{attrs:{prop:"supply",label:"Supply (10,000 tons)"}}),a("el-table-column",{attrs:{prop:"demand",label:"Demand (10,000 tons)"}}),a("el-table-column",{attrs:{prop:"option",label:"Operation",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"success"},on:{click:function(a){return e.handleEdit(t.row)}}},[e._v("Edit "),a("i",{staticClass:"el-icon-edit"})]),a("el-popconfirm",{staticClass:"ml-5",attrs:{"confirm-button-text":"DELETE","cancel-button-text":"CANCEL",icon:"el-icon-info","icon-color":"red",title:"Are you sure to delete?"},on:{confirm:function(a){return e.del(t.row.id)},cancel:e.cancel}},[a("el-button",{attrs:{slot:"reference",type:"danger"},slot:"reference"},[e._v("Delete "),a("i",{staticClass:"el-icon-remove-outline"})])],1)]}}])})],1),a("div",{staticStyle:{padding:"10px 0"}},[a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[5,10,20],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),a("el-dialog",{attrs:{title:"Market Information",visible:e.dialogFormVisible,width:"30%",center:""},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"marketForm",attrs:{"label-width":"auto",size:"small",model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{label:"Date",prop:"date"}},[a("el-col",{attrs:{span:11}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"select date","value-format":"yyyy-MM-dd"},model:{value:e.form.date,callback:function(t){e.$set(e.form,"date",t)},expression:"form.date"}})],1)],1),a("el-form-item",{attrs:{label:"Crop",prop:"crop"}},[a("el-select",{attrs:{filterable:"",placeholder:"Please select a crop name"},model:{value:e.form.crop,callback:function(t){e.$set(e.form,"crop",t)},expression:"form.crop"}},[a("el-option",{attrs:{label:"paddy",value:"paddy"}}),a("el-option",{attrs:{label:"potato",value:"potato"}}),a("el-option",{attrs:{label:"soybean",value:"soybean"}}),a("el-option",{attrs:{label:"peanut",value:"peanut"}}),a("el-option",{attrs:{label:"wheat",value:"wheat"}}),a("el-option",{attrs:{label:"barley",value:"barley"}})],1)],1),a("el-form-item",{attrs:{label:"Unit Price",prop:"unitPrice"}},[a("el-input",{attrs:{type:"number",autocomplete:"off",placeholder:"(GBP per ton)",onKeypress:"return (/[\\d]/.test(String.fromCharCode(event.keyCode)))"},model:{value:e.form.unitPrice,callback:function(t){e.$set(e.form,"unitPrice",e._n(t))},expression:"form.unitPrice"}})],1),a("el-form-item",{attrs:{label:"Supply"}},[a("el-input",{attrs:{type:"number",autocomplete:"off",placeholder:"(in 10,000 tons)",onKeypress:"return (/[\\d]/.test(String.fromCharCode(event.keyCode)))"},model:{value:e.form.supply,callback:function(t){e.$set(e.form,"supply",e._n(t))},expression:"form.supply"}})],1),a("el-form-item",{attrs:{label:"Demand"}},[a("el-input",{attrs:{type:"number",autocomplete:"off",placeholder:"(in 10,000 tons)",onKeypress:"return (/[\\d]/.test(String.fromCharCode(event.keyCode)))"},model:{value:e.form.demand,callback:function(t){e.$set(e.form,"demand",e._n(t))},expression:"form.demand"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.formCancel}},[e._v("Cancel")]),a("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("Confirm")])],1)],1)],1)},r=[],o=a(727),i={name:"Market",data(){return{tableData:[],total:0,currentPage:1,pageSize:5,crop:"",form:{},multipleSelection:[],dialogFormVisible:!1,rules:{date:[{required:!0,message:"Please choose the date",trigger:"blur"}],crop:[{required:!0,message:"Please choose one crop",trigger:"blur"}],unitPrice:[{required:!0,message:"Please input the price",trigger:"blur"}]},chartDateVal:[],dateVal:[],pickerOptions:{shortcuts:[{text:"within 7 days",onClick(e){const t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:"within 30 days",onClick(e){const t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}},{text:"within 90 days",onClick(e){const t=new Date,a=new Date;a.setTime(a.getTime()-7776e6),e.$emit("pick",[a,t])}}]}}},watch:{dateVal(e){null==e&&(this.dateVal="")},chartDateVal(e){null==e&&(this.chartDateVal="")}},created(){this.loadPage()},mounted(){this.chartDateVal[0]=this.getFormatDate(1),this.chartDateVal[1]=this.getFormatDate(0),this.getChart()},methods:{getFormatDate(e){var t=new Date,a="-",l=t.getFullYear()-e,r=t.getMonth()+1,o=t.getDate();r>=1&&r<=9&&(r="0"+r),o>=0&&o<=9&&(o="0"+o);var i=l+a+r+a+o;return i},rowClass(){return"text-align:center"},loadPage(){this.request.get("/market-trend/page",{params:{currentPage:this.currentPage,pageSize:this.pageSize,crop:this.crop,beginDate:this.dateVal[0],endDate:this.dateVal[1]}}).then((e=>{this.tableData=e.data.records,this.total=e.data.total;let t=parseInt((this.total-1)/this.pageSize+1);this.currentPage>t&&(this.currentPage=t)}))},handleSizeChange(e){this.pageSize=e,this.loadPage()},handleCurrentChange(e){this.currentPage=e,this.loadPage()},handleAdd(){this.dialogFormVisible=!0,this.form={}},save(){this.$refs["marketForm"].validate((e=>{e?this.request.post("/market-trend",this.form).then((e=>{200===e.code?(this.$message.success("Successfully saved"),this.dialogFormVisible=!1,this.loadPage()):this.$message.error("Failed to save, please try again")})):this.$message.error("Failed to save, please check that your data meets the requirements")}))},handleEdit(e){this.form=Object.assign({},e),this.dialogFormVisible=!0},del(e){this.request.delete("/market-trend/"+e).then((e=>{200===e.code?(this.$message.success("Successfully deleted"),this.loadPage()):this.$message.error("Failed to delete")}))},handleSelectionChange(e){this.multipleSelection=e},delBatch(){let e=this.multipleSelection.map((e=>e.id));this.request.post("/market-trend/batchDel",e).then((e=>{200===e.code?(this.$message.success("Successfully deleted"),this.loadPage()):this.$message.error("Failed to delete")}))},reset(){this.crop="",this.dateVal="",this.currentPage=1,this.loadPage()},cancel(){this.$message.warning("Operation successfully canceled")},formCancel(){this.dialogFormVisible=!1,this.$message.warning("Form submission canceled")},getChart(){var e=document.getElementById("price"),t=o.S1(e),a=document.getElementById("trend"),l=o.S1(a),r={title:{text:"Unit Price of Crops",left:"center",textStyle:{fontStyle:"normal",fontWeight:"bold",fontFamily:"Arial",fontSize:25}},tooltip:{trigger:"item",axisPointer:{type:"cross"}},legend:{orient:"horizontal",x:"center",y:"bottom"},grid:{left:"5%",right:"7%",top:"15%",bottom:"12%",containLabel:!0},toolbox:{show:!0,feature:{mark:{show:!0},magicType:{show:!0,type:["line","bar"]},saveAsImage:{show:!0}}},calculable:!0,xAxis:{name:"Date",type:"time",axisLabel:{show:!0,textStyle:{color:"green",fontSize:"13",fontWeight:"bold"}},axisLine:{lineStyle:{color:"black",width:2}}},yAxis:{name:"Price (GBP per ton)",type:"value",axisLabel:{show:!0,textStyle:{color:"black",fontSize:"10"}},axisLine:{lineStyle:{color:"black",width:2}}},series:[{name:"paddy",data:[],type:"line"},{name:"potato",data:[],type:"line"},{name:"soybean",data:[],type:"line"},{name:"peanut",data:[],type:"line"},{name:"wheat",data:[],type:"line"},{name:"barley",data:[],type:"line"}]},i={title:{text:"Demand and Production Comparison",subtext:"demand minus supply (local market)",left:"center",textStyle:{fontStyle:"normal",fontWeight:"bold",fontFamily:"Arial",fontSize:25}},tooltip:{trigger:"item",axisPointer:{type:"cross"}},legend:{orient:"horizontal",x:"center",y:"bottom"},grid:{left:"6%",right:"7%",top:"20%",bottom:"12%",containLabel:!0},toolbox:{show:!0,feature:{mark:{show:!0},magicType:{show:!0,type:["line","bar"]},saveAsImage:{show:!0}}},calculable:!0,xAxis:{name:"Date",type:"time",boundaryGap:!1,axisLabel:{show:!0,textStyle:{color:"green",fontSize:"13",fontWeight:"bold"}},axisLine:{lineStyle:{color:"black",width:2}}},yAxis:{name:"Quantity (10000 tons)",type:"value",axisLabel:{show:!0,textStyle:{color:"black",fontSize:"10"}},axisLine:{lineStyle:{color:"black",width:2}}},series:[{name:"paddy",data:[],type:"line"},{name:"potato",data:[],type:"line"},{name:"soybean",data:[],type:"line"},{name:"peanut",data:[],type:"line"},{name:"wheat",data:[],type:"line"},{name:"barley",data:[],type:"line"}]};this.request.get("/market-trend/chart",{params:{beginDate:this.chartDateVal[0],endDate:this.chartDateVal[1]}}).then((e=>{r.series[0].data=e.data[0].map((e=>[e.date,e.unitPrice])),r.series[1].data=e.data[1].map((e=>[e.date,e.unitPrice])),r.series[2].data=e.data[2].map((e=>[e.date,e.unitPrice])),r.series[3].data=e.data[3].map((e=>[e.date,e.unitPrice])),r.series[4].data=e.data[4].map((e=>[e.date,e.unitPrice])),r.series[5].data=e.data[5].map((e=>[e.date,e.unitPrice])),i.series[0].data=e.data[0].map((e=>[e.date,e.demand-e.supply])),i.series[1].data=e.data[1].map((e=>[e.date,e.demand-e.supply])),i.series[2].data=e.data[2].map((e=>[e.date,e.demand-e.supply])),i.series[3].data=e.data[3].map((e=>[e.date,e.demand-e.supply])),i.series[4].data=e.data[4].map((e=>[e.date,e.demand-e.supply])),i.series[5].data=e.data[5].map((e=>[e.date,e.demand-e.supply])),t.setOption(r),l.setOption(i)}))}}},s=i,n=a(1001),c=(0,n.Z)(s,l,r,!1,null,"c26a9a7a",null),d=c.exports}}]);
//# sourceMappingURL=703.e5ae86b4.js.map